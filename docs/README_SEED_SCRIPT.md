# Prisma ç§å­è„šæœ¬ä½¿ç”¨æŒ‡å—

## æ¦‚è¿°
`prisma/seed.js` è„šæœ¬ç”¨äºä¸ºè®ºæ–‡è·Ÿè¸ªç³»ç»Ÿåˆ›å»ºç¤ºä¾‹æ•°æ®ï¼ŒåŒ…æ‹¬ç”¨æˆ·ã€è®ºæ–‡å’Œè¿›åº¦è®°å½•ã€‚

## åˆ›å»ºçš„æ•°æ®

### ğŸ‘¥ ç”¨æˆ·æ•°æ®
- **ç®¡ç†å‘˜ç”¨æˆ·**ï¼š
  - ç”¨æˆ·å: `admin`
  - å¯†ç : `admin123`
  - é‚®ç®±: `admin@thesistracker.com`
  - è§’è‰²: `ADMIN`

- **æ™®é€šç”¨æˆ·**ï¼š
  - ç”¨æˆ·å: `student`
  - å¯†ç : `student123`
  - é‚®ç®±: `student@thesistracker.com`
  - è§’è‰²: `USER`

### ğŸ“„ è®ºæ–‡æ•°æ®
- ç®¡ç†å‘˜ç”¨æˆ·: 2ç¯‡è®ºæ–‡
- æ™®é€šç”¨æˆ·: 1ç¯‡è®ºæ–‡
- æ¯ç¯‡è®ºæ–‡åŒ…å«å®Œæ•´çš„ä¿¡æ¯ï¼šæ ‡é¢˜ã€æè¿°ã€æˆªæ­¢æ—¥æœŸã€ä¼˜å…ˆçº§ã€ç›®æ ‡å­—æ•°ç­‰

### ğŸ“ˆ è¿›åº¦è®°å½•
- æ¯ç¯‡è®ºæ–‡: 3æ¡è¿›åº¦è®°å½•
- è¿›åº¦ä»30%-95%ä¸ç­‰
- åŒ…å«ä¸åŒå†™ä½œé˜¶æ®µï¼šç ”ç©¶ã€å†™ä½œã€ä¿®æ”¹
- è®°å½•æ—¶é—´æ¶ˆè€—å’Œè¯¦ç»†å¤‡æ³¨

## ä½¿ç”¨æ–¹æ³•

### å‰ææ¡ä»¶
1. ç¡®ä¿å·²å®‰è£…ä¾èµ–ï¼š
   ```bash
   cd server
   npm install
   ```

2. ç¡®ä¿ç¯å¢ƒå˜é‡é…ç½®æ­£ç¡®ï¼š
   ```bash
   # åˆ›å»º .env æ–‡ä»¶
   echo "DATABASE_URL=\"your_database_connection_string\"" > .env
   ```

### è¿è¡Œç§å­è„šæœ¬

#### æ–¹æ³•1ï¼šä½¿ç”¨Prismaå‘½ä»¤ï¼ˆæ¨èï¼‰
```bash
cd server
npx prisma db seed
```

#### æ–¹æ³•2ï¼šç›´æ¥è¿è¡Œè„šæœ¬
```bash
cd server
node prisma/seed.js
```

#### æ–¹æ³•3ï¼šé€šè¿‡npm script
```bash
cd server
npm run seed  # å¦‚æœåœ¨package.jsonä¸­é…ç½®äº†æ­¤è„šæœ¬
```

## é…ç½®æ­¥éª¤

### 1. æ›´æ–°package.json
åœ¨`server/package.json`ä¸­æ·»åŠ seedé…ç½®ï¼š
```json
{
  "prisma": {
    "seed": "node prisma/seed.js"
  }
}
```

### 2. ç¡®è®¤Prismaé…ç½®
ç¡®ä¿`schema.prisma`æ–‡ä»¶ä¸­çš„æ•°æ®åº“é…ç½®æ­£ç¡®ï¼š
```prisma
datasource db {
  provider = "postgresql" // æˆ–å…¶ä»–æ•°æ®åº“
  url      = env("DATABASE_URL")
}
```

### 3. è®¾ç½®ç¯å¢ƒå˜é‡
åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º`.env`æ–‡ä»¶ï¼š
```env
# PostgreSQL
DATABASE_URL="postgresql://username:password@localhost:5432/thesis_tracker"

# MySQL  
DATABASE_URL="mysql://username:password@localhost:3306/thesis_tracker"

# SQLite
DATABASE_URL="file:./dev.db"
```

## æ‰§è¡Œæµç¨‹

ç§å­è„šæœ¬æŒ‰ä»¥ä¸‹é¡ºåºæ‰§è¡Œï¼š

```
1. è¿æ¥æ•°æ®åº“
   â†“
2. åˆ›å»ºç”¨æˆ· (admin + student)
   â†“  
3. åˆ›å»ºè®ºæ–‡ (ä¸ºæ¯ä¸ªç”¨æˆ·åˆ›å»ºè®ºæ–‡)
   â†“
4. åˆ›å»ºè¿›åº¦è®°å½• (ä¸ºæ¯ç¯‡è®ºæ–‡åˆ›å»º3æ¡è®°å½•)
   â†“
5. æ‰“å°ç»Ÿè®¡ä¿¡æ¯
   â†“
6. å…³é—­æ•°æ®åº“è¿æ¥
```

## åŠŸèƒ½ç‰¹æ€§

### ğŸ” å¯†ç å®‰å…¨
- ä½¿ç”¨bcryptè¿›è¡Œå¯†ç å“ˆå¸Œï¼ˆ12è½®ç›å€¼ï¼‰
- å¯†ç ä¸å¯é€†åŠ å¯†å­˜å‚¨

### ğŸ“… æ™ºèƒ½æ—¶é—´è®¡ç®—
- è‡ªåŠ¨è®¡ç®—æ¯æ—¥ç›®æ ‡å­—æ•°
- åŸºäºæˆªæ­¢æ—¥æœŸå’Œå‰©ä½™å¤©æ•°
- ç¡®ä¿åˆç†çš„è¿›åº¦å®‰æ’

### ğŸ“Š éšæœºåŒ–æ•°æ®
- è®ºæ–‡è¿›åº¦åœ¨åˆç†èŒƒå›´å†…éšæœºåŒ–
- æ¨¡æ‹ŸçœŸå®çš„å†™ä½œè¿›åº¦
- åŒ…å«ä¸åŒå†™ä½œé˜¶æ®µ

### ğŸ›¡ï¸ é”™è¯¯å¤„ç†
- å®Œæ•´çš„try-catché”™è¯¯å¤„ç†
- è¯¦ç»†çš„æ‰§è¡Œæ—¥å¿—è¾“å‡º
- æ•°æ®åº“è¿æ¥è‡ªåŠ¨ç®¡ç†

## è¾“å‡ºç¤ºä¾‹

æ‰§è¡ŒæˆåŠŸæ—¶ï¼Œä½ ä¼šçœ‹åˆ°å¦‚ä¸‹è¾“å‡ºï¼š

```
ğŸš€ å¼€å§‹æ‰§è¡Œæ•°æ®åº“ç§å­è„šæœ¬...

ğŸ‘¥ å¼€å§‹åˆ›å»ºç”¨æˆ·æ•°æ®...
âœ… ç®¡ç†å‘˜ç”¨æˆ·åˆ›å»ºæˆåŠŸ: admin (admin@thesistracker.com)
âœ… æ™®é€šç”¨æˆ·åˆ›å»ºæˆåŠŸ: student (student@thesistracker.com)

ğŸ“„ å¼€å§‹åˆ›å»ºè®ºæ–‡æ•°æ®...
âœ… è®ºæ–‡åˆ›å»ºæˆåŠŸ: "æ·±åº¦å­¦ä¹ åœ¨è‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„åº”ç”¨ç ”ç©¶"
âœ… è®ºæ–‡åˆ›å»ºæˆåŠŸ: "åŒºå—é“¾æŠ€æœ¯åœ¨ä¾›åº”é“¾ç®¡ç†ä¸­çš„å®‰å…¨æ€§åˆ†æ"  
âœ… è®ºæ–‡åˆ›å»ºæˆåŠŸ: "æœºå™¨å­¦ä¹ ç®—æ³•åœ¨åŒ»ç–—è¯Šæ–­ä¸­çš„åº”ç”¨"

ğŸ“ˆ å¼€å§‹åˆ›å»ºè¿›åº¦æ•°æ®...
âœ… è¿›åº¦è®°å½•åˆ›å»ºæˆåŠŸ: æ·±åº¦å­¦ä¹ åœ¨è‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„åº”ç”¨ç ”ç©¶ - 35%
âœ… è¿›åº¦è®°å½•åˆ›å»ºæˆåŠŸ: æ·±åº¦å­¦ä¹ åœ¨è‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„åº”ç”¨ç ”ç©¶ - 72%
âœ… è¿›åº¦è®°å½•åˆ›å»ºæˆåŠŸ: æ·±åº¦å­¦ä¹ åœ¨è‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„åº”ç”¨ç ”ç©¶ - 88%
...

ğŸ‰ æ•°æ®åº“ç§å­æ•°æ®åˆ›å»ºå®Œæˆï¼
ğŸ“Š æ•°æ®ç»Ÿè®¡:
   ğŸ‘¥ ç”¨æˆ·: 2 ä¸ª
   ğŸ“„ è®ºæ–‡: 3 ç¯‡  
   ğŸ“ˆ è¿›åº¦è®°å½•: 9 æ¡

ğŸ‘¤ æµ‹è¯•è´¦æˆ·ä¿¡æ¯:
   ç®¡ç†å‘˜è´¦æˆ·:
     ç”¨æˆ·å: admin
     å¯†ç : admin123
     é‚®ç®±: admin@thesistracker.com

   æ™®é€šç”¨æˆ·è´¦æˆ·:
     ç”¨æˆ·å: student
     å¯†ç : student123
     é‚®ç®±: student@thesistracker.com

ğŸ’¡ æç¤º: ä½¿ç”¨è¿™äº›è´¦æˆ·ç™»å½•ç³»ç»Ÿè¿›è¡Œæµ‹è¯•

ğŸ”Œ æ•°æ®åº“è¿æ¥å·²å…³é—­

âœ¨ ç§å­è„šæœ¬æ‰§è¡ŒæˆåŠŸï¼
```

## å¸¸è§é—®é¢˜

### Q: è„šæœ¬æ‰§è¡Œå¤±è´¥ï¼Œæç¤º"relation does not exist"
A: éœ€è¦å…ˆè¿è¡Œæ•°æ®åº“è¿ç§»ï¼š
```bash
npx prisma db push
# æˆ–
npx prisma migrate dev --name init
```

### Q: å¯†ç å“ˆå¸Œå¤±è´¥
A: ç¡®ä¿bcryptç‰ˆæœ¬å…¼å®¹ï¼š
```bash
npm install bcrypt@6.0.0
```

### Q: æ•°æ®åº“è¿æ¥å¤±è´¥
A: æ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®ï¼š
```bash
# éªŒè¯æ•°æ®åº“è¿æ¥
npx prisma db pull
```

### Q: æ•°æ®é‡å¤åˆ›å»º
A: è„šæœ¬ä¼šåˆ›å»ºå…¨æ–°çš„æ•°æ®ã€‚å¦‚éœ€æ¸…ç†ç°æœ‰æ•°æ®ï¼š
```bash
npx prisma migrate reset
```

## è‡ªå®šä¹‰æ•°æ®

å¦‚éœ€ä¿®æ”¹ç§å­æ•°æ®ï¼Œç¼–è¾‘`prisma/seed.js`æ–‡ä»¶ï¼š

### ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯
```javascript
const adminUser = {
  username: 'your_admin',
  email: 'admin@example.com',
  passwordHash: await hashPassword('your_password'),
  // ... å…¶ä»–å­—æ®µ
};
```

### ä¿®æ”¹è®ºæ–‡æ•°æ®
```javascript
const adminPapers = [
  {
    title: 'ä½ çš„è®ºæ–‡æ ‡é¢˜',
    description: 'è®ºæ–‡æè¿°',
    deadline: new Date('2024-12-31'),
    // ... å…¶ä»–å­—æ®µ
  }
];
```

## é›†æˆåˆ°CI/CD

å¯ä»¥å°†ç§å­è„šæœ¬é›†æˆåˆ°éƒ¨ç½²æµç¨‹ä¸­ï¼š
```yaml
# GitHub Actions ç¤ºä¾‹
- name: Seed database
  run: |
    cd server
    npm ci
    npx prisma db push
    npx prisma db seed
```

## æ‰©å±•åŠŸèƒ½

ç§å­è„šæœ¬æ”¯æŒä»¥ä¸‹æ‰©å±•ï¼š
- æ·»åŠ æ›´å¤šç”¨æˆ·å’Œè®ºæ–‡
- åˆ›å»ºä¸åŒçš„è¿›åº¦åœºæ™¯
- é›†æˆå¤–éƒ¨APIæ•°æ®
- ç”Ÿæˆç‰¹å®šä¸»é¢˜çš„è®ºæ–‡å†…å®¹

å¦‚éœ€è‡ªå®šä¹‰ï¼Œè¯·å‚è€ƒè„šæœ¬ä¸­çš„å‡½æ•°ç»“æ„è¿›è¡Œæ‰©å±•ã€‚